{"version":3,"file":"nested.js","names":["useProxiedModel","computed","inject","onBeforeMount","onBeforeUnmount","provide","ref","shallowRef","toRaw","toRef","toValue","independentActiveStrategy","independentSingleActiveStrategy","leafActiveStrategy","leafSingleActiveStrategy","listOpenStrategy","multipleOpenStrategy","singleOpenStrategy","classicSelectStrategy","independentSelectStrategy","independentSingleSelectStrategy","leafSelectStrategy","leafSingleSelectStrategy","trunkSelectStrategy","consoleError","getCurrentInstance","propsFactory","VNestedSymbol","Symbol","for","emptyNested","id","root","register","unregister","parents","Map","children","open","openOnSelect","activate","select","activatable","selectable","opened","Set","activated","selected","selectedValues","getPath","makeNestedProps","Boolean","activeStrategy","String","Function","Object","selectStrategy","openStrategy","mandatory","useNested","props","isUnmounted","v","Array","isArray","map","i","values","value","in","out","path","parent","unshift","get","vm","nodeIds","nested","arr","key","entries","push","parentId","isGroup","has","join","newPath","concat","add","set","delete","list","filter","child","event","emit","newOpened","newSelected","newActivated","size","useNestedItem","uidSymbol","computedId","item","e","isOpen","isActivated","isSelected","isIndeterminate","isLeaf","isGroupActivator","useNestedGroupActivator"],"sources":["../../../src/composables/nested/nested.ts"],"sourcesContent":["// Composables\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport {\n  computed,\n  inject,\n  onBeforeMount,\n  onBeforeUnmount,\n  provide,\n  ref,\n  shallowRef,\n  toRaw,\n  toRef,\n  toValue,\n} from 'vue'\nimport {\n  independentActiveStrategy,\n  independentSingleActiveStrategy,\n  leafActiveStrategy,\n  leafSingleActiveStrategy,\n} from './activeStrategies'\nimport { listOpenStrategy, multipleOpenStrategy, singleOpenStrategy } from './openStrategies'\nimport {\n  classicSelectStrategy,\n  independentSelectStrategy,\n  independentSingleSelectStrategy,\n  leafSelectStrategy,\n  leafSingleSelectStrategy,\n  trunkSelectStrategy,\n} from './selectStrategies'\nimport { consoleError, getCurrentInstance, propsFactory } from '@/util'\n\n// Types\nimport type { InjectionKey, MaybeRefOrGetter, PropType, Ref } from 'vue'\nimport type { ActiveStrategy } from './activeStrategies'\nimport type { OpenStrategy } from './openStrategies'\nimport type { SelectStrategy } from './selectStrategies'\nimport type { EventProp } from '@/util'\n\nexport type ActiveStrategyProp =\n  | 'single-leaf'\n  | 'leaf'\n  | 'independent'\n  | 'single-independent'\n  | ActiveStrategy\n  | ((mandatory: boolean) => ActiveStrategy)\nexport type SelectStrategyProp =\n  | 'single-leaf'\n  | 'leaf'\n  | 'independent'\n  | 'single-independent'\n  | 'classic'\n  | 'trunk'\n  | SelectStrategy\n  | ((mandatory: boolean) => SelectStrategy)\nexport type OpenStrategyProp = 'single' | 'multiple' | 'list' | OpenStrategy\n\nexport interface NestedProps {\n  activatable: boolean\n  selectable: boolean\n  activeStrategy: ActiveStrategyProp | undefined\n  selectStrategy: SelectStrategyProp | undefined\n  openStrategy: OpenStrategyProp | undefined\n  activated: any\n  selected: any\n  opened: any\n  mandatory: boolean\n  'onUpdate:activated': EventProp<[any]> | undefined\n  'onUpdate:selected': EventProp<[any]> | undefined\n  'onUpdate:opened': EventProp<[any]> | undefined\n}\n\ntype NestedProvide = {\n  id: Ref<unknown>\n  isGroupActivator?: boolean\n  root: {\n    children: Ref<Map<unknown, unknown[]>>\n    parents: Ref<Map<unknown, unknown>>\n    activatable: Ref<boolean>\n    selectable: Ref<boolean>\n    opened: Ref<Set<unknown>>\n    activated: Ref<Set<unknown>>\n    selected: Ref<Map<unknown, 'on' | 'off' | 'indeterminate'>>\n    selectedValues: Ref<unknown[]>\n    register: (id: unknown, parentId: unknown, isGroup?: boolean) => void\n    unregister: (id: unknown) => void\n    open: (id: unknown, value: boolean, event?: Event) => void\n    activate: (id: unknown, value: boolean, event?: Event) => void\n    select: (id: unknown, value: boolean, event?: Event) => void\n    openOnSelect: (id: unknown, value: boolean, event?: Event) => void\n    getPath: (id: unknown) => unknown[]\n  }\n}\n\nexport const VNestedSymbol: InjectionKey<NestedProvide> = Symbol.for('vuetify:nested')\n\nexport const emptyNested: NestedProvide = {\n  id: shallowRef(),\n  root: {\n    register: () => null,\n    unregister: () => null,\n    parents: ref(new Map()),\n    children: ref(new Map()),\n    open: () => null,\n    openOnSelect: () => null,\n    activate: () => null,\n    select: () => null,\n    activatable: ref(false),\n    selectable: ref(false),\n    opened: ref(new Set()),\n    activated: ref(new Set()),\n    selected: ref(new Map()),\n    selectedValues: ref([]),\n    getPath: () => [],\n  },\n}\n\nexport const makeNestedProps = propsFactory({\n  activatable: Boolean,\n  selectable: Boolean,\n  activeStrategy: [String, Function, Object] as PropType<ActiveStrategyProp>,\n  selectStrategy: [String, Function, Object] as PropType<SelectStrategyProp>,\n  openStrategy: [String, Object] as PropType<OpenStrategyProp>,\n  opened: null,\n  activated: null,\n  selected: null,\n  mandatory: Boolean,\n}, 'nested')\n\nexport const useNested = (props: NestedProps) => {\n  let isUnmounted = false\n  const children = shallowRef(new Map<unknown, unknown[]>())\n  const parents = shallowRef(new Map<unknown, unknown>())\n\n  const opened = useProxiedModel(\n    props,\n    'opened',\n    props.opened,\n    v => new Set(Array.isArray(v) ? v.map(i => toRaw(i)) : v),\n    v => [...v.values()],\n  )\n\n  const activeStrategy = computed(() => {\n    if (typeof props.activeStrategy === 'object') return props.activeStrategy\n    if (typeof props.activeStrategy === 'function') return props.activeStrategy(props.mandatory)\n\n    switch (props.activeStrategy) {\n      case 'leaf': return leafActiveStrategy(props.mandatory)\n      case 'single-leaf': return leafSingleActiveStrategy(props.mandatory)\n      case 'independent': return independentActiveStrategy(props.mandatory)\n      case 'single-independent':\n      default: return independentSingleActiveStrategy(props.mandatory)\n    }\n  })\n\n  const selectStrategy = computed(() => {\n    if (typeof props.selectStrategy === 'object') return props.selectStrategy\n    if (typeof props.selectStrategy === 'function') return props.selectStrategy(props.mandatory)\n\n    switch (props.selectStrategy) {\n      case 'single-leaf': return leafSingleSelectStrategy(props.mandatory)\n      case 'leaf': return leafSelectStrategy(props.mandatory)\n      case 'independent': return independentSelectStrategy(props.mandatory)\n      case 'single-independent': return independentSingleSelectStrategy(props.mandatory)\n      case 'trunk': return trunkSelectStrategy(props.mandatory)\n      case 'classic':\n      default: return classicSelectStrategy(props.mandatory)\n    }\n  })\n\n  const openStrategy = computed(() => {\n    if (typeof props.openStrategy === 'object') return props.openStrategy\n\n    switch (props.openStrategy) {\n      case 'list': return listOpenStrategy\n      case 'single': return singleOpenStrategy\n      case 'multiple':\n      default: return multipleOpenStrategy\n    }\n  })\n\n  const activated = useProxiedModel(\n    props,\n    'activated',\n    props.activated,\n    v => activeStrategy.value.in(v, children.value, parents.value),\n    v => activeStrategy.value.out(v, children.value, parents.value),\n  )\n  const selected = useProxiedModel(\n    props,\n    'selected',\n    props.selected,\n    v => selectStrategy.value.in(v, children.value, parents.value),\n    v => selectStrategy.value.out(v, children.value, parents.value),\n  )\n\n  onBeforeUnmount(() => {\n    isUnmounted = true\n  })\n\n  function getPath (id: unknown) {\n    const path: unknown[] = []\n    let parent: unknown = toRaw(id)\n\n    while (parent != null) {\n      path.unshift(parent)\n      parent = parents.value.get(parent)\n    }\n\n    return path\n  }\n\n  const vm = getCurrentInstance('nested')\n\n  const nodeIds = new Set<unknown>()\n\n  const nested: NestedProvide = {\n    id: shallowRef(),\n    root: {\n      opened,\n      activatable: toRef(() => props.activatable),\n      selectable: toRef(() => props.selectable),\n      activated,\n      selected,\n      selectedValues: computed(() => {\n        const arr = []\n\n        for (const [key, value] of selected.value.entries()) {\n          if (value === 'on') arr.push(key)\n        }\n\n        return arr\n      }),\n      register: (id, parentId, isGroup) => {\n        if (nodeIds.has(id)) {\n          const path = getPath(id).map(String).join(' -> ')\n          const newPath = getPath(parentId).concat(id).map(String).join(' -> ')\n          consoleError(`Multiple nodes with the same ID\\n\\t${path}\\n\\t${newPath}`)\n          return\n        } else {\n          nodeIds.add(id)\n        }\n\n        parentId && id !== parentId && parents.value.set(id, parentId)\n\n        isGroup && children.value.set(id, [])\n\n        if (parentId != null) {\n          children.value.set(parentId, [...children.value.get(parentId) || [], id])\n        }\n      },\n      unregister: id => {\n        if (isUnmounted) return\n\n        nodeIds.delete(id)\n        children.value.delete(id)\n        const parent = parents.value.get(id)\n        if (parent) {\n          const list = children.value.get(parent) ?? []\n          children.value.set(parent, list.filter(child => child !== id))\n        }\n        parents.value.delete(id)\n      },\n      open: (id, value, event) => {\n        vm.emit('click:open', { id, value, path: getPath(id), event })\n\n        const newOpened = openStrategy.value.open({\n          id,\n          value,\n          opened: new Set(opened.value),\n          children: children.value,\n          parents: parents.value,\n          event,\n        })\n\n        newOpened && (opened.value = newOpened)\n      },\n      openOnSelect: (id, value, event) => {\n        const newOpened = openStrategy.value.select({\n          id,\n          value,\n          selected: new Map(selected.value),\n          opened: new Set(opened.value),\n          children: children.value,\n          parents: parents.value,\n          event,\n        })\n        newOpened && (opened.value = newOpened)\n      },\n      select: (id, value, event) => {\n        vm.emit('click:select', { id, value, path: getPath(id), event })\n\n        const newSelected = selectStrategy.value.select({\n          id,\n          value,\n          selected: new Map(selected.value),\n          children: children.value,\n          parents: parents.value,\n          event,\n        })\n        newSelected && (selected.value = newSelected)\n\n        nested.root.openOnSelect(id, value, event)\n      },\n      activate: (id, value, event) => {\n        if (!props.activatable) {\n          return nested.root.select(id, true, event)\n        }\n\n        vm.emit('click:activate', { id, value, path: getPath(id), event })\n\n        const newActivated = activeStrategy.value.activate({\n          id,\n          value,\n          activated: new Set(activated.value),\n          children: children.value,\n          parents: parents.value,\n          event,\n        })\n\n        if (newActivated.size !== activated.value.size) {\n          activated.value = newActivated\n        } else {\n          for (const value of newActivated) {\n            if (!activated.value.has(value)) {\n              activated.value = newActivated\n              return\n            }\n          }\n          for (const value of activated.value) {\n            if (!newActivated.has(value)) {\n              activated.value = newActivated\n              return\n            }\n          }\n        }\n      },\n      children,\n      parents,\n      getPath,\n    },\n  }\n\n  provide(VNestedSymbol, nested)\n\n  return nested.root\n}\n\nexport const useNestedItem = (id: MaybeRefOrGetter<unknown>, isGroup: boolean) => {\n  const parent = inject(VNestedSymbol, emptyNested)\n\n  const uidSymbol = Symbol('nested item')\n  const computedId = computed(() => toRaw(toValue(id)) ?? uidSymbol)\n\n  const item = {\n    ...parent,\n    id: computedId,\n    open: (open: boolean, e: Event) => parent.root.open(computedId.value, open, e),\n    openOnSelect: (open: boolean, e?: Event) => parent.root.openOnSelect(computedId.value, open, e),\n    isOpen: computed(() => parent.root.opened.value.has(computedId.value)),\n    parent: computed(() => parent.root.parents.value.get(computedId.value)),\n    activate: (activated: boolean, e?: Event) => parent.root.activate(computedId.value, activated, e),\n    isActivated: computed(() => parent.root.activated.value.has(computedId.value)),\n    select: (selected: boolean, e?: Event) => parent.root.select(computedId.value, selected, e),\n    isSelected: computed(() => parent.root.selected.value.get(computedId.value) === 'on'),\n    isIndeterminate: computed(() => parent.root.selected.value.get(computedId.value) === 'indeterminate'),\n    isLeaf: computed(() => !parent.root.children.value.get(computedId.value)),\n    isGroupActivator: parent.isGroupActivator,\n  }\n\n  onBeforeMount(() => {\n    !parent.isGroupActivator && parent.root.register(computedId.value, parent.id.value, isGroup)\n  })\n\n  onBeforeUnmount(() => {\n    !parent.isGroupActivator && parent.root.unregister(computedId.value)\n  })\n\n  isGroup && provide(VNestedSymbol, item)\n\n  return item\n}\n\nexport const useNestedGroupActivator = () => {\n  const parent = inject(VNestedSymbol, emptyNested)\n\n  provide(VNestedSymbol, { ...parent, isGroupActivator: true })\n}\n"],"mappings":"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","ignoreList":[]}